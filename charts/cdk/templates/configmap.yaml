apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "cdk.fullname" . }}
  namespace: {{ .Release.Namespace }}
data:
  config.toml: |
    AggLayerURL = {{ .Values.config.agglayer.url | quote }}
    AggregatorPrivateKeyPassword = {{ .Values.config.sensitive.wallets.aggregator.password | quote }}
    AggregatorPrivateKeyPath = "/etc/cdk/aggregator.keystore"
    ContractVersions = {{ .Values.config.contractsVersion | quote }}
    ForkId = {{ .Values.config.rollup.forkId | int }}
    genesisBlockNumber = {{ .Values.config.rollupManager.creation.blockNumber | int }}
    IsValidiumMode = {{ eq .Values.config.isValidium true }}
    L1URL = {{ .Values.config.sensitive.l1.rpcUrl | quote }}
    L2Coinbase = {{ .Values.config.wallets.sequencer.address | quote }}
    L2URL = {{ .Values.config.l2.rpcUrl | quote }}
    PathRWData = {{ .Values.storage.path | quote }}
    polygonBridgeAddr = {{ .Values.config.rollupManager.bridgeAddress | quote }}
    rollupCreationBlockNumber = {{ .Values.config.rollup.creation.blockNumber | int }}
    rollupManagerCreationBlockNumber = {{ .Values.config.rollupManager.creation.blockNumber | int }}
    RPCURL = {{ .Values.config.l2.rpcUrl | quote }}
    SenderProofToL1Addr = {{ .Values.config.agglayer.address | quote }}
    SequencerPrivateKeyPassword = {{ .Values.config.sensitive.wallets.sequencer.password | quote }} 
    SequencerPrivateKeyPath =  "/etc/cdk/sequencer.keystore"
    WitnessURL = {{ .Values.config.l2.rpcUrl | quote }}

    [L1Config]
    chainId = {{ .Values.config.l1.chainId | int }}
    polygonZkEVMGlobalExitRootAddress = {{ .Values.config.rollupManager.globalExitRootManagerAddress | quote }}
    polygonRollupManagerAddress = {{ .Values.config.rollupManager.address | quote }}
    polTokenAddress = {{ .Values.config.rollupManager.polAddress | quote }}
    polygonZkEVMAddress = {{ .Values.config.rollup.address | quote }}
      
    [L2Config]
    GlobalExitRootAddr = {{ .Values.config.rollupManager.globalExitRootManagerAddress | quote }}

    [BridgeL2Sync]
    OriginNetwork={{ .Values.config.rollup.id | int }}

    [L1InfoTreeSync]
    SyncBlockChunkSize={{ .Values.config.l1.syncBlockChunkSize | int }}

    [Log]
    Environment = {{ .Values.config.log.environment | quote }}
    Level = {{ .Values.config.log.level | quote }}
    Outputs = ["stderr"]
          
    [AggSender]
    CertificateSendInterval = {{ .Values.config.aggSender.certificateSendInterval | quote }}
    CheckSettledInterval = {{ .Values.config.aggSender.checkSettledInterval | quote }}
    MaxCertSize = {{ .Values.config.aggSender.maxCertSize | int }}
    SaveCertificatesToFilesPath = {{ .Values.config.aggSender.saveCertificatesToFilesPath | quote }}

  sequencer.keystore: |
    {{ .Values.config.wallets.sequencer.keystore }}

  aggregator.keystore: |
    {{ .Values.config.wallets.aggregator.keystore }}

  genesis.json: |-
{{ .Values.genesis | indent 4 }}
